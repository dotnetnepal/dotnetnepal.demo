@model dotnetnepal.ViewModels.PostViewModel

@{
    ViewData["Title"] = "New Blog Post";
}

<h2>Write a New Post</h2>

<form method="POST" enctype="multipart/form-data">
    <div class="col-md-12 well">
        <div class="form-group col-md-6">
            <label for="Title">Title</></label>
            <input type="text" class="form-control" placeholder="" asp-for="Title" />
            <span asp-validation-for="Title" class="text-warning"></span>
        </div>
        <div class="form-group col-md-12">
            <label for="Body" class="primaryField">Body</label>
            <textarea rows="10" class="form-control" placeholder="" asp-for="Body" id="post-body"></textarea>
            <span asp-validation-for="Body" class="text-warning"></span>
        </div>
        <div class="form-group col-md-12">
            <label for="Excerpt" class="secondaryField">Excerpt (Optional)</label>
            <textarea class="form-control" placeholder="" asp-for="Excerpt"></textarea>
        </div>
        <div class="col-md-12">
            <div class="form-group">
                <label>Upload Files</label>
                <input type="file" name="files" multiple id="file-input" onchange="insertFiles()" />
            </div>
        </div>
        <div class="col-md-12">
            <input type="submit" name="save" class="btn btn-primary btn-sm" value="Save Draft" asp-page-handler="SaveDraft" />
            <input type="submit" name="publish" class="btn btn-primary btn-sm" value="Publish" asp-page-handler="Publish" />
        </div>
    </div>
</form>


<script>
    $("#file-input").change(insertFiles, false);

    function insertFiles() {
        var selectedFiles = document.getElementById("file-input");
        for (var i = 0; i < selectedFiles.files.length; i++) {
            var postBody = $("#post-body");
            var name = selectedFiles.files[i].name;
            postBody.val(postBody.val() + "\n![" + name + "](/Uploads/" + name + ")");
        }
    }
</script>